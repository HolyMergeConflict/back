# üìò Backend API: –ó–∞–¥–∞—á–Ω–∏–∫ —Å —Ä–æ–ª—è–º–∏, –∏—Å—Ç–æ—Ä–∏–µ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

## ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø—Ä–æ–µ–∫—Ç—É

### API-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- [x] Auth: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, —Ä–æ–ª–∏ ‚úÖ 2025-07-28
- [x] Tasks: CRUD, —Å–≤—è–∑–∫–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ ‚úÖ 2025-07-28
- [x] Users: –ø—Ä–æ—Ñ–∏–ª–∏, —Ä–æ–ª–∏ ‚úÖ 2025-07-28
- [x] Model-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è ‚úÖ 2025-07-28
- [x] –ò—Å—Ç–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ 2025-07-30
- [x] CRUD –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á), –º–æ–¥–µ—Ä–∞—Ü–∏—è ‚úÖ 2025-07-30
- [x] –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ (–±–∞–Ω, —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞–¥–∞—á) ‚úÖ 2025-07-30
- [x] –°–¥–µ–ª–∞—Ç—å API. ‚úÖ 2025-08-02 

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- [x] –ü–æ–¥–∫–ª—é—á–µ–Ω–∞ —á–µ—Ä–µ–∑ Tortoise ORM ‚úÖ 2025-07-28
- [x] –°–¥–µ–ª–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ SQLAlchemy? ‚úÖ 2025-07-28
- [x] –°–¥–µ–ª–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ PostgresSQL? - –ø–æ—Ç–æ–º, sqlite –ø–æ–π–¥–µ—Ç ‚úÖ 2025-07-28
- [x] –ü—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–µ–π ‚úÖ 2025-07-30
- [x] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –º–∏–≥—Ä–∞—Ü–∏—è ‚úÖ 2025-07-30
- [x] –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ ‚úÖ 2025-07-30
- [x] –ù–∞—á–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã (–∞–¥–º–∏–Ω-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏:
- [x] Sentry - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ ‚úÖ 2025-07-28
- [x] Prometheus - –º–µ—Ç—Ä–∏–∫–∏ ‚úÖ 2025-07-28
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (stdout + —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤) ‚úÖ 2025-08-11 
- [x] Healthcheck (/health) ‚úÖ 2025-08-11 

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- [x] Swagger/OpenAPI ‚úÖ 2025-07-28
- [x] README.md –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Docker –∏ –ø—Ä–æ–¥–∞–∫—à–Ω:
- [x] Dockerfile ‚úÖ 2025-07-28
- [x] docker-compose.yml ‚úÖ 2025-08-11 
- [x] –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ–∂–∏–º ‚úÖ 2025-08-11
- [x] .env —Ñ–∞–π–ª—ã ‚úÖ 2025-08-01

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- [x] JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚úÖ 2025-07-28
- [x] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º ‚úÖ 2025-07-28 

### –¢–µ—Å—Ç—ã:
- [x] Unit-—Ç–µ—Å—Ç—ã –Ω–∞ –ª–æ–≥–∏–∫—É ‚úÖ 2025-08-07
- [x] API-—Ç–µ—Å—Ç—ã ‚úÖ 2025-08-10
- [ ] –¢–µ—Å—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è

- Python 3.11+
- SQLite
- Redis (–¥–ª—è logout —Ç–æ–∫–µ–Ω–æ–≤)
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `poetry` –∏–ª–∏ `pip`
- –°–æ–∑–¥–∞–Ω `.env` —Ñ–∞–π–ª

### üìÑ –ü—Ä–∏–º–µ—Ä `.env`

```env
SECRET_KEY=supersecretkey
ACCESS_TOKEN_EXPIRE_MINUTES=10
SQL_URL=sqlite+aiosqlite:///./app.db
ALGORITHM=HS256
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=your-redis-password
ADMIN_USERNAME=admin
ADMIN_EMAIL=admin@admin.com
ADMIN_PASSWORD=admin-password
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

Poetry:
```bash
poetry install
```


---
#### –î–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞—é—Ç —Ç–æ–ª—å–∫–æ api, –±–µ–∑ –º–µ—Ç—Ä–∏–∫ –∏ redis (–Ω—É–∂–µ–Ω –¥–ª—è logout), –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è docker
### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Uvicorn:
```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `__main__` –±–ª–æ–∫:
```bash
python app/main.py
```

### Swagger UI

```
http://localhost:8000/docs
```
--- 
## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### 1. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
docker compose up -d --build
```
### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
docker compose ps
```
### 3. –õ–æ–≥–∏ (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
```bash
# –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose logs -f
# –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º
docker compose logs -f app
docker compose logs -f node-exporter
docker compose logs -f cadvisor
docker compose logs -f prometheus
docker compose logs -f grafana
```
### 4. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
```bash
docker compose down
```
## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

- API (Swagger): `http://localhost:8000/docs`
- –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `http://localhost:8000/metrics`
- Node Exporter: `http://localhost:9100/metrics`
- cAdvisor UI: `http://localhost:8080/`
---
# –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (Routers)

## Auth (`/auth`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `POST` | `/auth/login` | –õ–æ–≥–∏–Ω –∏ –≤—ã–¥–∞—á–∞ JWT |
| `POST` | `/auth/logout` | Logout —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ç–æ–∫–µ–Ω–∞ |

## Users (`/users`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `GET` | `/users/` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `GET` | `/users/me` | –ü—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `GET` | `/users/{user_id}` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID |
| `PUT` | `/users/{user_id}` | –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `PATCH` | `/users/{user_id}/role` | –û–±–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å |
| `PATCH` | `/users/{user_id}/promote/moderator` | –ü–æ–≤—ã—Å–∏—Ç—å –¥–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ |
| `PATCH` | `/users/{user_id}/promote/admin` | –ü–æ–≤—ã—Å–∏—Ç—å –¥–æ –∞–¥–º–∏–Ω–∞ |
| `PATCH` | `/users/{user_id}/demote` | –ü–æ–Ω–∏–∑–∏—Ç—å –¥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ |
| `DELETE` | `/users/{user_id}` | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

## Tasks (`/tasks`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/tasks/` | –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É |
| `GET` | `/tasks/` | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π |
| `GET` | `/tasks/my_tasks` | –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏ |
| `GET` | `/tasks/moderation` | –ó–∞–¥–∞—á–∏ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é |
| `GET` | `/tasks/{task_id}` | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ ID |
| `PUT` | `/tasks/{task_id}` | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É |
| `PATCH` | `/tasks/{task_id}/approve` | –û–¥–æ–±—Ä–∏—Ç—å –∑–∞–¥–∞—á—É |
| `PATCH` | `/tasks/{task_id}/reject` | –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É |
| `DELETE` | `/tasks/{task_id}` | –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É |

## Task History (`/task-history`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/task-history/` | –õ–æ–≥ –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è |
| `GET` | `/task-history/my` | –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ—é –∏—Å—Ç–æ—Ä–∏—é |
| `GET` | `/task-history/my/by-status` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É |
| `GET` | `/task-history/my/task/{task_id}` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ –∑–∞–¥–∞—á–µ |
| `GET` | `/task-history/my/task/{task_id}/latest` | –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–ø—ã—Ç–∫–∞ |
| `GET` | `/task-history/my/range` | –ò—Å—Ç–æ—Ä–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥ |


## Health (`/health`)
| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç   | –û–ø–∏—Å–∞–Ω–∏–µ                    |
|-------|------------|-----------------------------|
| `GET` | `/health/` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å |